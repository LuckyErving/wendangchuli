# 文档处理器 - 测试指南

## 测试用例准备

### 1. 创建测试文件夹

创建一个测试文件夹，包含以下文件（文件名包含关键字即可）：

```
测试文件夹/
├── 申请书.pdf
├── 户主声明书.docx
├── 承包方调查表.doc
├── 承包地块调查表01.pdf
├── 承包地块调查表02.pdf
├── 公示结果归户表.pdf
├── 公示无异议声明书.pdf
├── 土地承包合同书.pdf
├── 登记簿.docx
├── DKSYT01.jpg
├── DKSYT02.jpg
├── DKSYT03.jpg
├── 确权登记声明书.pdf
└── 承诺书.docx
```

### 2. 测试步骤

1. 运行程序
2. 点击"浏览"选择测试文件夹
3. 选择输出PDF保存位置
4. 点击"开始处理"
5. 等待完成

### 3. 预期结果

生成的PDF文件应该包含所有文档，按以下顺序：
1. 申请书
2. 户主声明书
3. 承包方调查表
4. 承包地块调查表01
5. 承包地块调查表02
6. 公示结果归户表
7. 公示无异议声明书
8. 土地承包合同书（重复4次）
9. 登记簿
10. DKSYT01（地块示意图按编号排序）
11. DKSYT02
12. DKSYT03
13. 确权登记声明书
14. 承诺书

### 4. 常见问题

#### 问题：窗口显示为黑色
**解决方法：**
- 这通常是主题或系统兼容性问题
- 已在代码中添加了修复
- 确保使用最新版本的代码

#### 问题：Word文档转换失败
**Mac：** 需要安装LibreOffice
```bash
brew install --cask libreoffice
```

**Windows：** 自动使用docx2pdf或Microsoft Word

#### 问题：某些文件未被识别
**检查项：**
- 文件名是否包含正确的关键字
- 地块示意图文件名格式：DKSYT + 两位数字（如DKSYT01）
- 文件格式是否支持

### 5. Mac上的测试

```bash
# 方法1：使用启动脚本
chmod +x run_mac.sh
./run_mac.sh

# 方法2：手动运行
source /Users/ervin/Studio/zPlayground/.venv/bin/activate
export TK_SILENCE_DEPRECATION=1
python document_processor.py
```

### 6. Windows上的测试

```batch
REM 首次运行
install_windows.bat

REM 之后每次运行
run.bat
```

## UI改进说明

最新版本包含以下UI改进：
- ✅ 更大的窗口尺寸（650x500）
- ✅ 窗口自动居中
- ✅ 更清晰的布局和分组
- ✅ 图标和表情符号增强可读性
- ✅ 进度条放在独立框架中
- ✅ 更友好的状态提示
- ✅ 彩色文本提高可读性

## 性能测试

建议测试场景：
1. 小量文件（5-10个文件）
2. 中等量文件（20-30个文件）
3. 大量文件（50+个文件）
4. 包含大图片的情况
5. 混合格式（PDF + Word + 图片）

## 日志记录

程序运行时会在控制台输出详细信息，用于调试。
